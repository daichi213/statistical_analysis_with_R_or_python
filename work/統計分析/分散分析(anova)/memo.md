# 分散分析

## [参考ページ](https://multivariate-statistics.com/2020/10/16/r-programming-one-way-anova/)

### 正規性検定

volcano datasetを使用して正規性検定を行なった。行方向と列方向でShapiroの正規性検定を行なったが、双方p値が0.05以下だったため双方とも正規性は持たない結果となったことがわかった。

```R
> dim(volcano)
[1] 87 61
# 行方向の値の取得
> volcano[c(1),]
 [1] 100 100 101 101 101 101 101 100 100 100 101 101
[13] 102 102 102 102 103 104 103 102 101 101 102 103
[25] 104 104 105 107 107 107 108 108 110 110 110 110
[37] 110 110 110 110 108 108 108 107 107 108 108 108
[49] 108 108 107 107 107 107 106 106 105 105 104 104
[61] 103
> head(volcano,1)
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
[1,]  100  100  101  101  101  101  101  100  100
     [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17]
[1,]   100   101   101   102   102   102   102   103
     [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
[1,]   104   103   102   101   101   102   103   104
     [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
[1,]   104   105   107   107   107   108   108   110
     [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41]
[1,]   110   110   110   110   110   110   110   108
     [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49]
[1,]   108   108   107   107   108   108   108   108
     [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57]
[1,]   108   107   107   107   107   106   106   105
     [,58] [,59] [,60] [,61]
[1,]   105   104   104   103
> qqnorm(volcano[c(1),])
> qqline(volcano[c(1),])
# pが0.05より大ければ正規性をもつ
> shapiro.test(t(volcano[c(1),]))

	Shapiro-Wilk normality test

data:  t(volcano[c(1), ])
W = 0.90832, p-value = 0.000238

# 列方向
> qqnorm(volcano[,c(1)])
> qqline(volcano[,c(1)])
> shapiro.test(volcano[,c(1)])

	Shapiro-Wilk normality test

data:  volcano[, c(1)]
W = 0.96955, p-value = 0.03794
```